'use client';

import Link from 'next/link';
import { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { AuroraBackground } from '@/components/ui/aurora-background';
import { SplineScene } from '@/components/ui/spline-scene';
import { GlobalSpotlight } from '@/components/ui/spotlight';

// Society names for the animated flipper
const societyNames = [
  'Drama Society',
  'Tech Club',
  'Photography Society',
  'Gaming Society',
  'Art Society',
  'Debate Union',
  'AI Society',
  'Hindu Society',
  'Dance Society',
  'Film Society',
];

// Static logos positioned around the robot - evenly spaced in orbital pattern
const orbitingLogos = [
  // Top row
  { id: 1, src: '/logos/filmmaking.png', name: 'Film Making', position: 'top-0 left-8', delay: 0 },
  { id: 7, src: '/logos/ba-econ.png', name: 'BA Econ', position: 'top-4 left-1/2 -translate-x-1/2', delay: 0.1 },
  { id: 2, src: '/logos/hindu-society.png', name: 'Hindu Society', position: 'top-0 right-8', delay: 0.2 },
  
  // Upper middle
  { id: 5, src: '/logos/awm.png', name: 'Asset Management', position: 'top-24 -left-6', delay: 0.3 },
  { id: 9, src: '/logos/psychology.png', name: 'Psychology', position: 'top-24 -right-6', delay: 0.4 },
  
  // Middle row
  { id: 11, src: '/logos/board-games.png', name: 'Board Games', position: 'top-1/2 -translate-y-1/2 -left-10', delay: 0.5 },
  { id: 6, src: '/logos/isoc.png', name: 'ISOC', position: 'top-1/2 -translate-y-1/2 -right-10', delay: 0.6 },
  
  // Lower middle
  { id: 8, src: '/logos/drama.png', name: 'Drama', position: 'bottom-32 -left-4', delay: 0.7 },
  { id: 10, src: '/logos/acs.png', name: 'ACS', position: 'bottom-32 -right-4', delay: 0.8 },
  
  // Bottom row
  { id: 3, src: '/logos/love-society.png', name: 'Love Society', position: 'bottom-8 left-12', delay: 0.9 },
  { id: 4, src: '/logos/baking.png', name: 'Baking Society', position: 'bottom-8 right-12', delay: 1.0 },
];

export default function LandingPage() {
  const [currentIndex, setCurrentIndex] = useState(0);
  const [isMobile, setIsMobile] = useState(false);
  const [failedImages, setFailedImages] = useState<Set<number>>(new Set());

  // Check for mobile
  useEffect(() => {
    const checkMobile = () => {
      if (typeof window !== 'undefined') {
        setIsMobile(window.innerWidth < 1024);
      }
    };
    checkMobile();
    window.addEventListener('resize', checkMobile);
    return () => window.removeEventListener('resize', checkMobile);
  }, []);

  // Flip through society names
  useEffect(() => {
    const interval = setInterval(() => {
      setCurrentIndex((prev) => (prev + 1) % societyNames.length);
    }, 2000);
    return () => clearInterval(interval);
  }, []);

  return (
    <AuroraBackground className="relative">
      {/* Cursor Glow Effect */}
      <GlobalSpotlight size={400} color="rgba(99, 102, 241, 0.06)" />

      {/* Header */}
      <header className="fixed top-0 left-0 right-0 z-50 bg-bg/60 backdrop-blur-xl border-b border-border/50">
        <div className="max-w-[1200px] mx-auto px-6 py-4 flex items-center justify-between">
          <Link href="/" className="flex items-center gap-1">
            <span className="text-3xl font-bold text-text tracking-tight">
              RM<span className="text-red">.</span>
            </span>
          </Link>
          <div className="flex items-center gap-4">
            <Link
              href="/discover"
              className="text-sm text-muted hover:text-text transition-colors font-medium"
            >
              Explore Events
            </Link>
            <Link
              href="/about"
              className="text-sm px-4 py-2 bg-text text-white rounded-lg font-medium hover:bg-gray-800 transition-colors"
            >
              Get the App
            </Link>
          </div>
        </div>
      </header>

      {/* Hero Section */}
      <section className="relative min-h-screen flex items-center pt-20">
        <div className="max-w-[1200px] mx-auto px-6 w-full">
          <div className="grid lg:grid-cols-2 gap-8 lg:gap-4 items-center min-h-[80vh]">
            {/* Left: Text Content */}
            <motion.div
              initial={{ opacity: 0, y: 30 }}
              animate={{ opacity: 1, y: 0 }}
              transition={{ duration: 0.6, ease: 'easeOut' }}
              className="relative z-10 max-w-2xl"
            >
              {/* Logo */}
              <motion.img
                src="/logos/Redefine Me logo wno bg.png"
                alt="Redefine Me"
                initial={{ opacity: 0, y: 10 }}
                animate={{ opacity: 1, y: 0 }}
                transition={{ delay: 0.1 }}
                className="h-36 md:h-44 w-auto mt-4 mb-2 -ml-6 object-contain object-left"
              />

              {/* Badge */}
              <motion.div
                initial={{ opacity: 0, y: 10 }}
                animate={{ opacity: 1, y: 0 }}
                transition={{ delay: 0.2 }}
                className="inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-surface border border-border mb-8"
              >
                <span className="w-2 h-2 rounded-full bg-green-500 animate-pulse" />
                <span className="text-xs text-muted font-medium">Live in Manchester</span>
              </motion.div>

              {/* Main Heading - BIGGER */}
              <motion.h1
                initial={{ opacity: 0, y: 20 }}
                animate={{ opacity: 1, y: 0 }}
                transition={{ delay: 0.3, duration: 0.6 }}
                className="text-[48px] md:text-[60px] lg:text-[68px] font-bold text-text tracking-[-0.03em] leading-[1.05] mb-6"
              >
                Your uni life,
                <br />
                <span className="text-red">all in one</span> place.
              </motion.h1>

              {/* Subtitle */}
              <motion.p
                initial={{ opacity: 0, y: 20 }}
                animate={{ opacity: 1, y: 0 }}
                transition={{ delay: 0.4, duration: 0.6 }}
                className="text-muted text-[17px] leading-[1.6] mb-5 max-w-md"
              >
                Never miss a society event again. 800+ events from Manchester universities, one platform.
              </motion.p>

              {/* Animated Society Flipper */}
              <motion.div
                initial={{ opacity: 0 }}
                animate={{ opacity: 1 }}
                transition={{ delay: 0.5 }}
                className="text-muted text-[15px] mb-8"
              >
                Find events from{' '}
                <span className="relative inline-block min-w-[180px] h-[24px] align-bottom">
                  <AnimatePresence mode="wait">
                    <motion.span
                      key={currentIndex}
                      initial={{ opacity: 0, y: 10 }}
                      animate={{ opacity: 1, y: 0 }}
                      exit={{ opacity: 0, y: -10 }}
                      transition={{ duration: 0.3 }}
                      className="absolute left-0 font-semibold text-red"
                    >
                      {societyNames[currentIndex]}
                    </motion.span>
                  </AnimatePresence>
                </span>
              </motion.div>

              {/* CTA Buttons */}
              <motion.div
                initial={{ opacity: 0, y: 20 }}
                animate={{ opacity: 1, y: 0 }}
                transition={{ delay: 0.6, duration: 0.6 }}
                className="flex flex-wrap gap-3"
              >
                <Link
                  href="/discover"
                  className="inline-flex items-center gap-2 px-6 py-3 bg-text text-white font-medium rounded-lg hover:bg-gray-800 transition-all text-sm group"
                >
                  Explore Events
                  <svg className="w-4 h-4 group-hover:translate-x-0.5 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 8l4 4m0 0l-4 4m4-4H3" />
                  </svg>
                </Link>
                <Link
                  href="/about"
                  className="inline-flex items-center gap-2 px-6 py-3 bg-transparent text-text font-medium rounded-lg border border-border hover:bg-surface hover:border-text/30 transition-all text-sm"
                >
                  Learn More
                </Link>
              </motion.div>

              {/* Stats */}
              <motion.div
                initial={{ opacity: 0 }}
                animate={{ opacity: 1 }}
                transition={{ delay: 0.8 }}
                className="mt-10 flex items-center gap-6 text-sm"
              >
                <div>
                  <p className="text-xl font-bold text-text">800+</p>
                  <p className="text-muted text-xs">Societies</p>
                </div>
                <div className="w-px h-8 bg-border" />
                <div>
                  <p className="text-xl font-bold text-text">3</p>
                  <p className="text-muted text-xs">Universities</p>
                </div>
                <div className="w-px h-8 bg-border" />
                <div>
                  <p className="text-xl font-bold text-text">2.4k+</p>
                  <p className="text-muted text-xs">Students</p>
                </div>
              </motion.div>
            </motion.div>

            {/* Right: Spline Robot Scene with Static Logos */}
            <motion.div
              initial={{ opacity: 0, scale: 0.95 }}
              animate={{ opacity: 1, scale: 1 }}
              transition={{ delay: 0.4, duration: 0.8 }}
              className="relative h-[500px] lg:h-[600px] hidden lg:block"
            >
              {/* Glow behind robot */}
              <div className="absolute inset-0 bg-gradient-to-br from-blue-500/10 via-transparent to-purple-500/10 rounded-full blur-3xl" />
              
              {/* Static Orbiting Logos - positioned around the robot */}
              {!isMobile && orbitingLogos.map((logo) => (
                <motion.div
                  key={logo.id}
                  className={`absolute ${logo.position} z-20 pointer-events-none`}
                  initial={{ opacity: 0, scale: 0 }}
                  animate={{ opacity: 1, scale: 1 }}
                  transition={{ delay: logo.delay + 0.8, duration: 0.5, type: 'spring' }}
                >
                  {/* Floating animation */}
                  <motion.div
                    animate={{
                      y: [0, -8, 0],
                      rotate: [0, 2, -2, 0],
                    }}
                    transition={{
                      duration: 4 + logo.delay * 2,
                      repeat: Infinity,
                      ease: 'easeInOut',
                    }}
                  >
                    {/* Circular frame with glow */}
                    <div className="relative w-14 h-14 rounded-full overflow-hidden border-2 border-white/30 shadow-xl shadow-black/20 bg-white">
                      {/* Subtle glow ring */}
                      <div className="absolute -inset-1 bg-gradient-to-br from-indigo-500/20 to-purple-500/20 rounded-full blur-sm -z-10" />
                      {/* Logo image */}
                      {!failedImages.has(logo.id) ? (
                        <img
                          src={logo.src}
                          alt={logo.name}
                          className="w-full h-full object-cover"
                          onError={() => setFailedImages(prev => new Set(prev).add(logo.id))}
                        />
                      ) : (
                        <div className="w-full h-full flex items-center justify-center bg-gradient-to-br from-indigo-500 to-purple-600 text-white text-xs font-bold">
                          {logo.name.split(' ').map(w => w[0]).join('').slice(0, 2)}
                        </div>
                      )}
                    </div>
                  </motion.div>
                </motion.div>
              ))}

              {/* Spline Scene - Robot tracks cursor */}
              <div className="relative w-full h-full">
                <SplineScene
                  scene="https://prod.spline.design/kZDDjO5HuC9GJUM2/scene.splinecode"
                  className="w-full h-full"
                />
              </div>
            </motion.div>
          </div>
        </div>
      </section>

      {/* Trust Section */}
      <section className="relative z-10 border-t border-border bg-surface/30 backdrop-blur-sm">
        <div className="max-w-[1200px] mx-auto px-6 py-10 text-center">
          <p className="text-muted text-[15px]">
            <span className="font-semibold text-text">800+ societies</span> from{' '}
            <span className="font-semibold text-text">3 universities</span> in{' '}
            <span className="font-semibold text-text">Manchester</span>
            {' '}— all in one place.
          </p>
          <div className="mt-6 flex justify-center items-center gap-10 opacity-40">
            <span className="text-lg font-bold text-muted">UoM</span>
            <span className="text-lg font-bold text-muted">MMU</span>
            <span className="text-lg font-bold text-muted">Salford</span>
          </div>
        </div>
      </section>

      {/* Footer */}
      <footer className="relative z-10 border-t border-border bg-bg">
        <div className="max-w-[1200px] mx-auto px-6 py-6 flex flex-col md:flex-row items-center justify-between gap-4">
          <div className="flex items-center gap-2">
            <span className="text-lg font-bold text-text tracking-tight">
              RM<span className="text-red">.</span>
            </span>
            <span className="text-sm text-muted">© 2026 Redefine Me</span>
          </div>
          <div className="flex items-center gap-6 text-sm text-muted">
            <Link href="/about" className="hover:text-text transition-colors">About</Link>
            <Link href="/discover" className="hover:text-text transition-colors">Discover</Link>
            <a href="mailto:hello@redefineme.app" className="hover:text-text transition-colors">Contact</a>
          </div>
        </div>
      </footer>
    </AuroraBackground>
  );
}
